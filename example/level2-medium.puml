@startuml
!include <awslib/AWSCommon>
!include <awslib/AWSSimplified.puml>
!include <awslib/Storage/SimpleStorageServiceS3.puml>
!include <awslib/ApplicationIntegration/SQS.puml>
!include <awslib/Compute/Lambda.puml>
!include <awslib/Database/DynamoDB.puml>
!include <awslib/NetworkingContentDelivery/APIGateway.puml>

'Define resources
SimpleStorageServiceS3(sourceBucket, "Source Bucket", "Stores incoming files")
SimpleStorageServiceS3(processedBucket, "Processed Bucket", "Stores processed files")
SQS(processingQueue, "Processing Queue", "Queues files for processing")
Lambda(processorFunction, "Processor Function", "Processes files from S3")
Lambda(apiFunction, "API Function", "Handles API requests")
DynamoDB(metadataTable, "Metadata Table", "Stores file metadata")
APIGateway(apiGateway, "API Gateway", "RESTful API endpoint")

'Define relationships
sourceBucket --> processingQueue : "File upload notifications"
processingQueue --> processorFunction : "Triggers"
processorFunction --> sourceBucket : "Reads files"
processorFunction --> processedBucket : "Writes processed files"
processorFunction --> metadataTable : "Stores metadata"
apiGateway --> apiFunction : "Routes requests"
apiFunction --> metadataTable : "Queries metadata"
apiFunction --> processedBucket : "Retrieves files"

@enduml